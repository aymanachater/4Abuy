<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>4Abuy - Shopping Cart</title>
  <link rel="icon" href="logo.png" type="image/png">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    body{font-family:'Segoe UI',Arial,sans-serif;margin:0;background:#f8f8f8;color:#111}#cart-count{color:red!important;font-weight:700;font-size:.9rem;margin-left:4px}.announcement{background:#f4f4f4;color:#111;text-align:center;font-size:1rem;padding:.5rem;letter-spacing:1px}header{position:fixed;top:0;left:0;width:100%;z-index:999;box-shadow:0 2px 6px rgba(0,0,0,.15);background-color:#fff;color:#111;display:flex;justify-content:space-between;align-items:center;padding:10px 20px}.header-left{display:flex;align-items:center;gap:1rem}.menu-icon{font-size:24px;cursor:pointer}.icons{display:flex;gap:20px;font-size:20px;padding-right:40px;align-items:center;white-space:nowrap}.icons i{cursor:pointer;transition:transform .2s}.icons i:hover{transform:scale(1.2)}.icons a{color:#000}.cart-title{font-size:2.5rem;text-align:center;padding-top:120px;margin-top:0;margin-bottom:20px;color:#2c2c2c;letter-spacing:2px}.cart-empty-message{text-align:center;font-size:1.8rem;font-weight:600;color:#888;padding:100px 20px;min-height:200px;display:flex;justify-content:center;align-items:center}.cart-container{padding-top:20px;max-width:1200px;margin:0 auto;padding-left:20px;padding-right:20px;padding-bottom:20px}.cart-item{display:flex;align-items:center;margin-bottom:20px;border-bottom:1px solid #ddd;padding-bottom:20px}.cart-item img{width:250px;height:auto;object-fit:cover;margin-right:20px;border-radius:8px;}.cart-item-details{flex-grow:1;display:flex;flex-direction:column}.cart-item-details h3{margin:0}.cart-item-remove{background:#ff4d4d;color:#fff;border:none;padding:10px 15px;cursor:pointer;border-radius:5px;margin-top:15px;width:100%;box-sizing:border-box;font-weight:600}.cart-item-remove:hover{background:#e60000}.cart-item-selector{margin-top:10px;display:flex;align-items:center;gap:10px;flex-wrap:wrap}.cart-item-selector label{font-weight:600;min-width:70px;text-align:left}.cart-item-selector select{padding:6px 8px;border-radius:5px;border:1px solid #ccc;font-family:'Segoe UI',Arial,sans-serif;font-size:.95rem;background-color:#fff;min-width:120px}.quantity-selector{display:flex;align-items:center;border:1px solid #ccc;border-radius:5px;width:fit-content}.quantity-btn{background-color:#f5f5f5;border:none;cursor:pointer;padding:8px 12px;font-size:1.1rem;font-weight:700;transition:background-color .2s}.quantity-btn:hover{background-color:#e0e0e0}.quantity-input{width:45px;text-align:center;border:none;font-size:1rem;font-weight:600;-moz-appearance:textfield;background:#fff}.quantity-input::-webkit-outer-spin-button,.quantity-input::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.quantity-selector .minus-btn{border-right:1px solid #ccc;border-radius:4px 0 0 4px}.quantity-selector .plus-btn{border-left:1px solid #ccc;border-radius:0 4px 4px 0}.auth-modal{display:none;position:fixed;z-index:10000;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:rgba(0,0,0,.6);justify-content:center;align-items:center;font-family:'Segoe UI',Arial,sans-serif}.auth-modal-content{background-color:#fff;margin:auto;padding:30px;border-radius:12px;box-shadow:0 0 30px rgba(0,0,0,.3);width:90%;max-width:450px;position:relative;text-align:center}.auth-modal .close-btn{position:absolute;top:10px;right:20px;color:#aaa;font-size:28px;font-weight:700;cursor:pointer}.auth-modal h2{margin-top:0;margin-bottom:25px;font-size:1.8rem;color:#333}.auth-modal input[type=email],.auth-modal input[type=password]{width:calc(100% - 24px);padding:12px;margin-bottom:20px;border:1px solid #ccc;border-radius:5px;font-size:1rem;box-sizing:border-box}.auth-modal button[type=submit]{background-color:#000;color:#fff;padding:12px 20px;border:none;border-radius:25px;cursor:pointer;font-size:1rem;font-weight:600;width:100%;transition:background-color .2s;box-sizing:border-box}.auth-modal .switch-form-link{display:block;margin-top:20px;font-size:.9rem;color:#555}.auth-modal .switch-form-link a{color:#cc00aa;text-decoration:underline;font-weight:700;cursor:pointer}.search-overlay{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.8);z-index:10001;justify-content:center;align-items:flex-start;padding-top:100px}.search-container{width:90%;max-width:600px;background:#fff;padding:20px;border-radius:8px;position:relative}.search-form{display:flex;gap:10px}.search-input{flex:1;padding:12px;border:2px solid #ddd;border-radius:4px;font-size:16px}.search-submit{padding:12px 24px;background:#000;color:#fff;border:none;border-radius:4px;cursor:pointer}.close-search{position:absolute;top:-40px;right:0;color:#fff;font-size:24px;cursor:pointer}.search-results-container{margin-top:15px;max-height:400px;overflow-y:auto;background:#fdfdfd;border-radius:4px;border:1px solid #eee;display:none}.search-result-item{display:flex;align-items:center;padding:10px;border-bottom:1px solid #f0f0f0;text-decoration:none;color:inherit}.search-result-item:last-child{border-bottom:none}.search-result-item img{width:60px;height:60px;object-fit:cover;margin-right:15px;border-radius:4px}.search-result-details{flex-grow:1}.search-result-details h4{margin:0 0 5px;font-size:1rem}.search-result-details p{margin:0;font-size:.9rem;color:#333;font-weight:700}.search-result-item .shop-now{padding:6px 12px;font-size:.8rem;white-space:nowrap}.about-us{padding:60px 20px;background:#f8f8f8;max-width:1200px;margin:0 auto}@media (max-width:768px){.cart-item{flex-direction:column;align-items:flex-start}.cart-item img{width:100%;margin-right:0;margin-bottom:15px;align-self:center}.cart-item-details{width:100%}}
  </style>
</head>
<body>

  <div id="sideMenu" style="width:0;position:fixed;z-index:10001;top:0;left:0;background-color:#fff;overflow-x:hidden;transition:ease-out .4s;padding-top:20px;box-shadow:rgba(0,0,0,.2) 0 5px 20px"><a href="javascript:void(0)" style="position:absolute;top:15px;right:25px;font-size:36px;text-decoration:none;color:#555" id="closeSideMenu">×</a><div style="padding:10px 15px 15px;font-size:1.1rem;font-weight:700;color:#111;display:flex;align-items:center;border-bottom:1px solid #f0f0f0;margin:0 15px 10px">CATEGORY <span style="margin-left:10px;font-size:.8rem">▼</span></div><a href="shop-womens.html" style="padding:12px 30px;text-decoration:none;font-size:1rem;color:#333;display:block;transition:all .3s ease 0s">WOMENS COLLECTION</a> <a href="shop-mens.html" style="padding:12px 30px;text-decoration:none;font-size:1rem;color:#333;display:block;transition:all .3s ease 0s">MENS COLLECTION</a> <a href="winter-collection.html" style="padding:12px 30px;text-decoration:none;font-size:1rem;color:#333;display:block;transition:all .3s ease 0s">WINTER COLLECTION</a> <a href="summer-collection.html" style="padding:12px 30px;text-decoration:none;font-size:1rem;color:#333;display:block;transition:all .3s ease 0s">SUMMER COLLECTION</a> <a href="autumn-collection.html" style="padding:12px 30px;text-decoration:none;font-size:1rem;color:#333;display:block;transition:all .3s ease 0s">AUTUMN COLLECTION</a> <a href="streetwear-urban.html" style="padding:12px 30px;text-decoration:none;font-size:1rem;color:#333;display:block;transition:all .3s ease 0s">STREETWEAR & URBAN</a> <a href="kids-clothing.html" style="padding:12px 30px;text-decoration:none;font-size:1rem;color:#333;display:block;transition:all .3s ease 0s">KIDS' CLOTHING</a> <a href="everyday-luxe.html" style="padding:12px 30px;text-decoration:none;font-size:1rem;color:#333;display:block;transition:all .3s ease 0s">EVERYDAY LUXE</a> <a href="fit-mode.html" style="padding:12px 30px;text-decoration:none;font-size:1rem;color:#333;display:block;transition:all .3s ease 0s">FIT MODE</a></div>
  <div class="announcement">JOIN OUR LOYALTY PROGRAM & ENJOY THE BENEFITS!</div>
  <header>
    <div class="header-left"><div class="menu-icon"><i class="fas fa-bars"></i></div><a href="index.html"><img src="logo.png" alt="4Abuy Logo" style="height:40px"></a></div>
    <div class="icons"><i class="fas fa-search" onclick="openSearchOverlay()"></i><a href="cart.html"><i class="fas fa-shopping-cart"></i><span id="cart-count">0</span></a><i class="fas fa-user" id="userAccountIcon" style="cursor:pointer"></i></div>
  </header>

  <h1 class="cart-title">YOUR CART</h1>
  <div class="cart-container" id="cart-items"></div>
  <div id="cart-total" style="max-width:1200px;margin:20px auto;font-size:1.2rem;font-weight:700;text-align:right;padding-right:20px">Total Price: 0.00 DH</div>
  <div id="paypal-button-container" style="max-width:750px;margin:20px auto 40px;padding:0 20px"></div>

  <div id="loginModal" class="auth-modal">
    <div class="auth-modal-content">
      <span class="close-btn" onclick="closeModal('loginModal')">×</span>
      <h2>Login</h2>
      <form id="loginForm">
        <input type="email" id="loginEmail" placeholder="Email Address" required>
        <input type="password" id="loginPassword" placeholder="Password" required>
        <button type="submit">LOGIN</button>
      </form>
      <p class="switch-form-link">Don't have an account? <a onclick="openModal('signupModal'); closeModal('loginModal'); return false;">Sign Up</a></p>
    </div>
  </div>

  <div id="signupModal" class="auth-modal">
    <div class="auth-modal-content">
      <span class="close-btn" onclick="closeModal('signupModal')">×</span>
      <h2>Create Account</h2>
      <form id="signupForm">
        <input type="text" id="signupFirstName" placeholder="First Name" required style="margin-bottom: 10px; padding: 10px; font-size: 1rem; border-radius: 5px; border: 1px solid #ccc; width: calc(100% - 22px); box-sizing: border-box;">
        <input type="email" id="signupEmail" placeholder="Email Address" required>
        <input type="password" id="signupPassword" placeholder="Password" required>
        <button type="submit">SIGN UP</button>
      </form>
      <p class="switch-form-link">Already have an account? <a onclick="openModal('loginModal'); closeModal('signupModal'); return false;">Login</a></p>
    </div>
  </div>
  
  <script src="https://www.paypal.com/sdk/js?client-id=AW4mFXiCm4jDyiUAbUftg97fSoOnXv1LQURG_1604-Ju_5vRDye21zvHJu_S91JvkNAyJ4nl0UocJhrS&currency=MAD"></script>
  
  <script>
    function renderPayPalButton() {
        const cart = JSON.parse(localStorage.getItem('cart')) || [];
        const total = cart.reduce((sum, item) => {
            const price = parseFloat(String(item.price).replace(/[^0-9.-]+/g, ""));
            return sum + (price * (item.quantity || 1));
        }, 0).toFixed(2);

        const paypalContainer = document.getElementById('paypal-button-container');
        if (paypalContainer) {
            paypalContainer.innerHTML = ''; 
            if (total > 0.00) {
                paypal.Buttons({
                    createOrder: function(data, actions) {
                        const currentTotal = JSON.parse(localStorage.getItem('cart')).reduce((sum, item) => sum + (parseFloat(String(item.price).replace(/[^0-9.-]+/g, "")) * (item.quantity || 1)), 0).toFixed(2);
                        return actions.order.create({
                            purchase_units: [{
                                amount: {
                                    value: currentTotal,
                                    currency_code: 'MAD'
                                }
                            }]
                        });
                    },
                    onApprove: function(data, actions) {
                        return actions.order.capture().then(function(details) {
                            alert('Transaction completed! Thank you, ' + details.payer.name.given_name);
                            localStorage.removeItem('cart');
                            if(typeof renderCartItems === 'function'){
                                renderCartItems(); 
                            } else {
                                window.location.reload();
                            }
                        });
                    },
                    onError: function(err) {
                        console.error('PayPal Error:', err);
                        alert('An error occurred during payment. Please try again.');
                    }
                }).render('#paypal-button-container');
            }
        }
    }
  </script>

  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
  <script src="cart.js"></script>
  
  <script>
    // General page scripts (Auth, Menu, etc.)
    const firebaseConfig={apiKey:"AIzaSyDelMOFKyvYx4u9FCgpq1HTr9eAoyjBjS0",authDomain:"abuy-77b4e.firebaseapp.com",projectId:"abuy-77b4e",storageBucket:"abuy-77b4e.appspot.com",messagingSenderId:"1081289117876",appId:"1:1081289117876:web:b3479e942dea9dc14607e1",measurementId:"G-31SH8VCRYG"};firebase.initializeApp(firebaseConfig);const auth=firebase.auth();document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".menu-icon"),t=document.getElementById("sideMenu"),n=document.getElementById("closeSideMenu");e&&e.addEventListener("click",e=>{e.stopPropagation(),t.style.width="280px"}),n&&n.addEventListener("click",()=>{t.style.width="0"}),window.addEventListener("click",n=>{const o=document.querySelector(".menu-icon");n.target===t||t.contains(n.target)||n.target===o||o.contains(n.target)||"280px"===t.style.width&&(t.style.width="0")});const o=document.getElementById("loginForm"),d=document.getElementById("signupForm"),i=document.getElementById("userAccountIcon");o&&o.addEventListener("submit",async e=>{e.preventDefault();const t=document.getElementById("loginEmail").value,n=document.getElementById("loginPassword").value;try{await auth.signInWithEmailAndPassword(t,n),closeModal("loginModal")}catch(e){alert("Login failed: "+e.message)}}),d&&d.addEventListener("submit",async e=>{e.preventDefault();const t=document.getElementById("signupFirstName").value.trim(),n=document.getElementById("signupEmail").value,o=document.getElementById("signupPassword").value;try{const e=await auth.createUserWithEmailAndPassword(n,o);await e.user.updateProfile({displayName:t}),closeModal("signupModal")}catch(e){alert("Signup failed: "+e.message)}}),auth.onAuthStateChanged(e=>{const t=document.getElementById("userDropupMenu"),n=document.getElementById("welcomeUserName");e?(i&&(i.className="fas fa-user-check",i.onclick=()=>{t.style.display="block"===t.style.display?"none":"block"}),n&&(n.textContent=e.displayName||"user"),closeModal("loginModal"),closeModal("signupModal")):(i&&(i.className="fas fa-user",i.onclick=()=>openModal("loginModal")),t&&(t.style.display="none"),n&&(n.textContent="user"))})});function openModal(e){document.getElementById(e).style.display="flex"}function closeModal(e){document.getElementById(e).style.display="none"}
  </script>
</body>
</html>
