<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Shopping Cart - 4Abuy</title>
    <link rel="icon" href="logo.png" type="image/png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { font-family: 'Segoe UI', Arial, sans-serif; margin: 0; background: #f8f8f8; color: #111; }
        #cart-count{color:red!important;font-weight:700;font-size:.9rem;margin-left:4px}
        .announcement { background: #f4f4f4; color: #111; text-align: center; font-size: 1rem; padding: .5rem; letter-spacing: 1px; }
        header { position: fixed; top: 0; left: 0; width: 100%; z-index: 999; box-shadow: 0 2px 6px rgba(0,0,0,.15); background-color: #fff; color: #111; display: flex; justify-content: space-between; align-items: center; padding: 10px 20px; }
        .header-left { display: flex; align-items: center; gap: 1rem; }
        .menu-icon { font-size: 24px; cursor: pointer; }
        .icons { display: flex; gap: 20px; font-size: 20px; padding-right: 40px; align-items: center; white-space: nowrap; }
        .icons i { cursor: pointer; transition: transform .2s; }
        .icons i:hover { transform: scale(1.2); }
        .icons a { color: #000; }

        .cart-container { padding: 120px 20px 40px; max-width: 1000px; margin: 0 auto; }
        .cart-container h1 { text-align: center; margin-bottom: 40px; }
        .cart-items { border-collapse: collapse; width: 100%; box-shadow: 0 2px 10px rgba(0,0,0,.06); background: #fff; border-radius: 8px; overflow: hidden; }
        .cart-items th, .cart-items td { padding: 15px; text-align: left; }
        .cart-items thead { background-color: #f4f4f4; }
        .cart-items th { font-weight: 600; }
        .cart-items tbody tr { border-bottom: 1px solid #eee; }
        .cart-item-details { display: flex; align-items: center; }
        .cart-item-details img { width: 80px; height: 80px; object-fit: cover; border-radius: 4px; margin-right: 15px; }
        .item-info h4 { margin: 0; font-size: 1rem; }
        .item-info p { margin: 5px 0 0; font-size: 0.9rem; color: #555; }
        .quantity-controls { display: flex; align-items: center; }
        .quantity-controls button { background: #ddd; border: none; padding: 5px 10px; cursor: pointer; }
        .quantity-controls span { padding: 0 15px; font-weight: bold; }
        .remove-btn { color: #e74c3c; cursor: pointer; font-size: 1.2rem; }
        .cart-summary { margin-top: 30px; background: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,.06); }
        .cart-summary h2 { margin-top: 0; }
        .summary-row { display: flex; justify-content: space-between; margin-bottom: 15px; }
        .checkout-btn { display: block; width: 100%; padding: 15px; background: #000; color: #fff; text-align: center; border: none; border-radius: 5px; cursor: pointer; font-size: 1.1rem; font-weight: bold; }
        #emptyCartMessage { text-align: center; padding: 50px; }

        /* Auth Modals */
        .auth-modal{display:none;position:fixed;z-index:10000;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:rgba(0,0,0,.6);justify-content:center;align-items:center;font-family:'Segoe UI',Arial,sans-serif}.auth-modal-content{background-color:#fff;margin:auto;padding:30px;border-radius:12px;box-shadow:0 0 30px rgba(0,0,0,.3);width:90%;max-width:450px;position:relative;text-align:center}.auth-modal .close-btn{position:absolute;top:10px;right:20px;color:#aaa;font-size:28px;font-weight:700;cursor:pointer}.auth-modal h2{margin-top:0;margin-bottom:25px;font-size:1.8rem;color:#333}.auth-modal input[type=email],.auth-modal input[type=password]{width:calc(100% - 24px);padding:12px;margin-bottom:20px;border:1px solid #ccc;border-radius:5px;font-size:1rem;box-sizing:border-box}.auth-modal button[type=submit]{background-color:#000;color:#fff;padding:12px 20px;border:none;border-radius:25px;cursor:pointer;font-size:1rem;font-weight:600;width:100%;transition:background-color .2s;box-sizing:border-box}.auth-modal .switch-form-link{display:block;margin-top:20px;font-size:.9rem;color:#555}.auth-modal .switch-form-link a{color:#cc00aa;text-decoration:underline;font-weight:700;cursor:pointer}

        /* Search Overlay Styles */
        .search-overlay{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.8);z-index:10001;justify-content:center;align-items:flex-start;padding-top:100px}
        .search-container{width:90%;max-width:600px;background:#fff;padding:20px;border-radius:8px;position:relative}
        .search-form{display:flex;gap:10px}.search-input{flex:1;padding:12px;border:2px solid #ddd;border-radius:4px;font-size:16px}
        .search-submit{padding:12px 24px;background:#000;color:#fff;border:none;border-radius:4px;cursor:pointer}
        .close-search{position:absolute;top:-40px;right:0;color:#fff;font-size:24px;cursor:pointer}
        .search-results-container{margin-top:15px;max-height:400px;overflow-y:auto;background:#fdfdfd;border-radius:4px;border:1px solid #eee;display:none}
        .search-result-item{display:flex;align-items:center;padding:10px;border-bottom:1px solid #f0f0f0; text-decoration: none; color: inherit;}
        .search-result-item:last-child{border-bottom:none}.search-result-item img{width:60px;height:60px;object-fit:cover;margin-right:15px;border-radius:4px}
        .search-result-details{flex-grow:1}.search-result-details h4{margin:0 0 5px;font-size:1rem}
        .search-result-details p{margin:0;font-size:.9rem;color:#333;font-weight:700}
        .search-result-item .shop-now{padding:6px 12px;font-size:.8rem;white-space:nowrap; margin-left: auto; background-color:#000; color:#fff; border:none; border-radius:20px; cursor:pointer;}

    </style>
</head>
<body>

    <div id="sideMenu" style="width: 0px; position: fixed; z-index: 10001; top: 0px; left: 0px; background-color: rgb(255, 255, 255); overflow-x: hidden; transition: ease-out 0.4s; padding-top: 20px; box-shadow: rgba(0, 0, 0, 0.2) 0px 5px 20px;">
        <a href="javascript:void(0)" style="position: absolute; top: 15px; right: 25px; font-size: 36px; text-decoration: none; color: rgb(85, 85, 85);" id="closeSideMenu">×</a>
        <div style="padding: 10px 15px 15px; font-size: 1.1rem; font-weight: 700; color: rgb(17, 17, 17); display: flex; align-items: center; border-bottom: 1px solid rgb(240, 240, 240); margin: 0px 15px 10px;">
          CATEGORY <span style="margin-left: 10px; font-size: 0.8rem;">▼</span>
        </div>
        <a href="shop-womens.html" style="padding: 12px 30px; text-decoration: none; font-size: 1rem; color: rgb(51, 51, 51); display: block; transition: all 0.3s ease 0s;">WOMENS COLLECTION</a>
        <a href="shop-mens.html" style="padding: 12px 30px; text-decoration: none; font-size: 1rem; color: rgb(51, 51, 51); display: block; transition: all 0.3s ease 0s;">MENS COLLECTION</a>
        <a href="winter-collection.html" style="padding: 12px 30px; text-decoration: none; font-size: 1rem; color: rgb(51, 51, 51); display: block; transition: all 0.3s ease 0s;">WINTER COLLECTION</a>
        <a href="summer-collection.html" style="padding: 12px 30px; text-decoration: none; font-size: 1rem; color: rgb(51, 51, 51); display: block; transition: all 0.3s ease 0s;">SUMMER COLLECTION</a>
        <a href="autumn-collection.html" style="padding: 12px 30px; text-decoration: none; font-size: 1rem; color: rgb(51, 51, 51); display: block; transition: all 0.3s ease 0s;">AUTUMN COLLECTION</a>
        <a href="streetwear-urban.html" style="padding: 12px 30px; text-decoration: none; font-size: 1rem; color: rgb(51, 51, 51); display: block; transition: all 0.3s ease 0s;">STREETWEAR &amp; URBAN</a>
        <a href="kids-clothing.html" style="padding: 12px 30px; text-decoration: none; font-size: 1rem; color: rgb(51, 51, 51); display: block; transition: all 0.3s ease 0s;">KIDS' CLOTHING</a>
        <a href="everyday-luxe.html" style="padding: 12px 30px; text-decoration: none; font-size: 1rem; color: rgb(51, 51, 51); display: block; transition: all 0.3s ease 0s;">EVERYDAY LUXE</a>
        <a href="fit-mode.html" style="padding: 12px 30px; text-decoration: none; font-size: 1rem; color: rgb(51, 51, 51); display: block; transition: all 0.3s ease 0s;">FIT MODE</a>
    </div>

    <div class="announcement">
        JOIN OUR LOYALTY PROGRAM & ENJOY THE BENEFITS!
    </div>
    <header>
        <div class="header-left">
            <div class="menu-icon">
                <i class="fas fa-bars"></i>
            </div>
            <a href="index.html">
                <img src="logo.png" alt="4Abuy Logo" style="height: 40px;">
            </a>
        </div>
        <div class="icons">
            <i class="fas fa-search" onclick="openSearchOverlay()"></i>
            <a href="cart.html"><i class="fas fa-shopping-cart"></i><span id="cart-count">0</span></a>
            <i class="fas fa-user" id="userAccountIcon" style="cursor: pointer;"></i>
        </div>
    </header>

    <div class="search-overlay" id="searchOverlay">
        <div class="search-container">
            <span class="close-search" onclick="closeSearchOverlay()">×</span>
            <form class="search-form" onsubmit="handleSearch(event)">
                <input type="text" class="search-input" placeholder="Search for products..." oninput="dynamicSearch(this.value)" required>
                <button type="submit" class="search-submit">Search</button>
            </form>
            <div id="searchResults" class="search-results-container"></div>
        </div>
    </div>

    <div class="cart-container" id="cartContainer">
        <h1>Your Shopping Cart</h1>
        <div id="cartContent">
            <table class="cart-items">
                <thead>
                    <tr>
                        <th>Product</th>
                        <th>Price</th>
                        <th>Quantity</th>
                        <th>Total</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody id="cartItemsBody">
                    </tbody>
            </table>
            <div class="cart-summary" id="cartSummary">
                <h2>Cart Summary</h2>
                <div class="summary-row">
                    <span>Subtotal</span>
                    <span id="subtotalPrice">$0.00</span>
                </div>
                <div class="summary-row">
                    <span>Shipping</span>
                    <span>Free</span>
                </div>
                <hr>
                <div class="summary-row" style="font-weight: bold; font-size: 1.2rem;">
                    <span>Total</span>
                    <span id="totalPrice">$0.00</span>
                </div>
                <button class="checkout-btn" onclick="alert('Proceeding to checkout!')">Proceed to Checkout</button>
            </div>
        </div>
        <div id="emptyCartMessage" style="display: none;">
            <h2>Your cart is empty.</h2>
            <p>Looks like you haven't added anything to your cart yet.</p>
            <a href="index.html" style="display: inline-block; margin-top: 20px; padding: 10px 20px; background: #000; color: #fff; text-decoration: none; border-radius: 5px;">Continue Shopping</a>
        </div>
    </div>
    
    <div id="loginModal" class="auth-modal">
        <div class="auth-modal-content">
          <span class="close-btn" onclick="closeModal('loginModal')">×</span>
          <h2>Login</h2>
          <form id="loginForm">
            <input type="email" id="loginEmail" placeholder="Email Address" required>
            <input type="password" id="loginPassword" placeholder="Password" required>
            <button type="submit">LOGIN</button>
          </form>
          <p class="switch-form-link">Don't have an account? <a onclick="openModal('signupModal'); closeModal('loginModal'); return false;">Sign Up</a></p>
        </div>
    </div>
    
    <div id="signupModal" class="auth-modal">
        <div class="auth-modal-content">
          <span class="close-btn" onclick="closeModal('signupModal')">×</span>
          <h2>Create Account</h2>
          <form id="signupForm">
            <input type="text" id="signupFirstName" placeholder="First Name" required style="margin-bottom: 10px; padding: 10px; font-size: 1rem; border-radius: 5px; border: 1px solid #ccc; width: calc(100% - 22px); box-sizing: border-box;">
            <input type="email" id="signupEmail" placeholder="Email Address" required>
            <input type="password" id="signupPassword" placeholder="Password" required>
            <button type="submit">SIGN UP</button>
          </form>
          <p class="switch-form-link">Already have an account? <a onclick="openModal('loginModal'); closeModal('signupModal'); return false;">Login</a></p>
        </div>
    </div>

    <div id="userDropupMenu" style="display:none; position: absolute; top: 50px; right: 20px; width: 250px; background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.15); font-family: 'Segoe UI', Arial, sans-serif; z-index: 10000; padding: 15px;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
          <strong style="font-size: 1.1rem;">Welcome <span id="welcomeUserName" style="font-weight: 900;">user</span></strong>
          <span id="closeDropup" style="cursor: pointer; font-weight: bold; font-size: 1.2rem;">×</span>
        </div>
        <div style="font-weight: 600; margin-bottom: 8px; cursor: pointer;" id="accountSettingsMain">Account Settings</div>
        <div style="padding: 8px 0; cursor: pointer; display: flex; align-items: center; gap: 8px;" id="passwordPersonalInfoMain"><i class="fas fa-lock"></i> Password &amp; Personal Info</div>
        <div style="font-weight: 600; margin: 15px 0 8px 0;">We're here to help, 24/7</div>
        <div style="padding: 8px 0; cursor: pointer; display: flex; align-items: center; gap: 8px;" id="contactUs"><i class="fas fa-comment"></i> Contact Us</div>
        <div style="padding: 8px 0; cursor: pointer; display: flex; align-items: center; gap: 8px;" id="signOutMain"><i class="fas fa-sign-out-alt"></i> Sign Out</div>
    </div>
    <div id="userAccountSettingsMenu" style="display:none; position: absolute; top: 50px; right: 20px; width: 280px; background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.15); font-family: 'Segoe UI', Arial, sans-serif; z-index: 10000; padding: 15px;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
          <button id="backToMainMenu" style="background:none; border:none; font-size: 1.2rem; cursor: pointer;">←</button>
          <strong style="font-size: 1.1rem;">Welcome <span id="welcomeUserNameSettings" style="font-weight: 900;">user</span></strong>
          <span id="closeSettingsDropup" style="cursor: pointer; font-weight: bold; font-size: 1.2rem;">×</span>
        </div>
        <div style="margin-bottom: 10px;">
          <label for="userNameDisplay" style="font-weight: 600;">Name:</label>
          <div id="userNameDisplay" style="padding: 6px 8px; background: #f0f0f0; border-radius: 4px; margin-top: 4px;">User Name</div>
        </div>
        <div style="margin-bottom: 10px;">
          <label for="userEmailDisplay" style="font-weight: 600;">Email:</label>
          <div id="userEmailDisplay" style="padding: 6px 8px; background: #f0f0f0; border-radius: 4px; margin-top: 4px;">user@example.com</div>
        </div>
        <div style="margin-bottom: 15px;">
          <label for="newPasswordInput" style="font-weight: 600;">Change Password:</label>
          <input type="password" id="newPasswordInput" placeholder="New Password" style="width: 100%; padding: 6px 8px; margin-top: 4px; border: 1px solid #ccc; border-radius: 4px;">
          <button id="changePasswordBtn" style="margin-top: 8px; width: 100%; padding: 8px; background: #000; color: #fff; border: none; border-radius: 4px; cursor: pointer;">Change Password</button>
        </div>
        <div style="padding: 8px 0; cursor: pointer; display: flex; align-items: center; gap: 8px;" id="signOutSettings"><i class="fas fa-sign-out-alt"></i> Sign Out</div>
    </div>
    
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
    <script src="cart.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- SCRIPT TO CONTROL THE SIDE MENU ---
            const menuIcon = document.querySelector('.menu-icon');
            const sideMenu = document.getElementById('sideMenu');
            const closeSideMenu = document.getElementById('closeSideMenu');

            if (menuIcon) {
                menuIcon.addEventListener('click', (event) => {
                    event.stopPropagation();
                    sideMenu.style.width = '280px';
                });
            }

            if (closeSideMenu) {
                closeSideMenu.addEventListener('click', () => {
                    sideMenu.style.width = '0';
                });
            }
             window.addEventListener('click', (event) => {
                const menuIconContainer = document.querySelector('.menu-icon');
                if (event.target !== sideMenu && !sideMenu.contains(event.target) && event.target !== menuIconContainer && !menuIconContainer.contains(event.target)) {
                    if (sideMenu.style.width === '280px') {
                        sideMenu.style.width = '0';
                    }
                }
            });
        });

        // --- GLOBAL PRODUCTS ARRAY FOR SEARCH ---
        const products = [
            // Autumn Collection
            { name: "VARSITY POLO CROP TOP", price: "38.50", image: "https://res.cloudinary.com/dav8t2igs/image/upload/v1750180851/Screenshot_20250617_181650_Gallery_suych0.jpg", url: "autumn-collection.html" },
            { name: "MEN'S RELAXED FIT POLO", price: "38.50", image: "https://res.cloudinary.com/dav8t2igs/image/upload/v1750180851/Screenshot_20250617_181659_Gallery_nxmaz7.jpg", url: "autumn-collection.html" },
            { name: "SUMMER MEADOW DRESS", price: "82.50", image: "https://res.cloudinary.com/dav8t2igs/image/upload/v1750180852/Screenshot_20250617_181628_Gallery_cvryuy.jpg", url: "autumn-collection.html" },
            { name: "GUIRENIAO MEN'S POLO SHIRT", price: "38.50", image: "https://res.cloudinary.com/dav8t2igs/image/upload/v1750180862/Screenshot_20250617_181211_Gallery_y1cfyx.jpg", url: "autumn-collection.html" },
            { name: "MEN'S LIGHT BLUE JEANS", price: "44.00", image: "https://res.cloudinary.com/dav8t2igs/image/upload/v1750180856/Screenshot_20250617_181457_Gallery_ztknre.jpg", url: "autumn-collection.html" },
            { name: "THE FLORA DRESS", price: "82.50", image: "https://res.cloudinary.com/dav8t2igs/image/upload/v1750180853/Screenshot_20250617_181601_Gallery_rnpkwg.jpg", url: "autumn-collection.html" },
            // Everyday Luxe
            { name: "PROVENCAL GARDEN DRESS", price: "82.50", image: "https://res.cloudinary.com/dav8t2igs/image/upload/v1750180852/Screenshot_20250617_181638_Gallery_ixl6bn.jpg", url: "everyday-luxe.html" },
            { name: "BLUE PORCELAIN BOW TOP", price: "44.00", image: "https://res.cloudinary.com/dav8t2igs/image/upload/v1750180854/Screenshot_20250617_181530_Gallery_ti9e6z.jpg", url: "everyday-luxe.html" },
            // Fit Mode
            { name: "WOMEN'S GYM & BARBELL GRAPHIC PRINT T-SHIRT", price: "22.00", image: "https://res.cloudinary.com/dav8t2igs/image/upload/v1750180859/Screenshot_20250617_181348_Gallery_crqzwx.jpg", url: "fit-mode.html" },
            { name: "MEN'S ATHELTIC PANTS", price: "33.00", image: "https://res.cloudinary.com/dav8t2igs/image/upload/v1750180859/Screenshot_20250617_181337_Gallery_tepxet.jpg", url: "fit-mode.html" },
            { name: "MEN'S QUICK-DRY ATHLETIC SHORTS", price: "22.00", image: "https://res.cloudinary.com/dav8t2igs/image/upload/v1750180856/Screenshot_20250617_181436_Gallery_fv8smt.jpg", url: "fit-mode.html" },
            { name: "MEN'S HOODED SHORT SLEEVE T-SHIRT", price: "33.00", image: "https://res.cloudinary.com/dav8t2igs/image/upload/v1750180858/Screenshot_20250617_181359_Gallery_atdeza.jpg", url: "fit-mode.html" },
            { name: "MEN'S QUICK-DRY VEST", price: "22.00", image: "https://res.cloudinary.com/dav8t2igs/image/upload/v1750180857/Screenshot_20250617_181412_Gallery_dchdbt.jpg", url: "fit-mode.html" },
            { name: "MEN'S HIGH-NECK ATHLETIC T-SHIRT", price: "33.00", image: "https://res.cloudinary.com/dav8t2igs/image/upload/v1750180857/Screenshot_20250617_181423_Gallery_jxcxm7.jpg", url: "fit-mode.html" },
            // Kids Clothing
            { name: "BOYS' SUMMER DENIM 2PCS SET", price: "33.00", image: "https://res.cloudinary.com/dav8t2igs/image/upload/v1750180857/Screenshot_20250617_181447_Gallery_xiab27.jpg", url: "kids-clothing.html" },
            { name: "4PCS SET FOR BABY BOYS", price: "38.50", image: "https://res.cloudinary.com/dav8t2igs/image/upload/v1750180864/Screenshot_20250617_181023_Gallery_kahkjg.jpg", url: "kids-clothing.html" },
            { name: "2PCS YOUNG BOY'S CASUAL CARTOON BEAR", price: "27.50", image: "https://res.cloudinary.com/dav8t2igs/image/upload/v1750180864/Screenshot_20250617_180943_Gallery_b063l5.jpg", url: "kids-clothing.html" },
            { name: "YOUNGSTERS BOYS SUMMER SOLID COLOR JACQUARD 2PCS", price: "27.50", image: "https://res.cloudinary.com/dav8t2igs/image/upload/v1750184012/Screenshot_20250617_191315_Dropbox_qlllms.jpg", url: "kids-clothing.html" },
            { name: "NEW GIRLS' ROUND NECK SHORT SLEEVE", price: "38.50", image: "https://res.cloudinary.com/dav8t2igs/image/upload/v1750180860/Screenshot_20250617_181308_Gallery_v4nydq.jpg", url: "kids-clothing.html" },
            { name: "2PCS TRENDY GIRLS SUMMER OUTFIT", price: "33.00", image: "https://res.cloudinary.com/dav8t2igs/image/upload/v1750180861/Screenshot_20250617_181325_Gallery_uugn2e.jpg", url: "kids-clothing.html" },
            // Mens Collection
            { name: "MEN'S LINEN SHIRT & SHORTS SET", price: "44.00", image: "https://res.cloudinary.com/dav8t2igs/image/upload/v1750180850/Screenshot_20250617_181716_Gallery_j4vtix.jpg", url: "shop-mens.html" },
            { name: "MEN'S WINTER JACKET", price: "60.50", image: "https://res.cloudinary.com/dav8t2igs/image/upload/v1750180862/Screenshot_20250617_181225_Gallery_dnzl0z.jpg", url: "shop-mens.html" },
            { name: "MENS' CASUAL SHORT SLEEVE T-SHIRT AND SHORT SET-KNIT", price: "38.50", image: "https://res.cloudinary.com/dav8t2igs/image/upload/v1750180854/Screenshot_20250617_181509/Gallery_euud9i.jpg", url: "shop-mens.html" },
            // Womens Collection
            { name: "HIGH-NECK ZIP-UP PUFFER JACKET", price: "55.00", image: "https://res.cloudinary.com/dav8t2igs/image/upload/v1750180853/Screenshot_20250617_181546_Gallery_g8xvaz.jpg", url: "shop-womens.html" },
            // Winter Collection
            { name: "MEN'S VINTAGE-INSPIRED CREWNECK SWEATSHIRT", price: "38.50", image: "https://res.cloudinary.com/dav8t2igs/image/upload/v1750180863/Screenshot_20250617_181156_Gallery_qabe76.jpg", url: "winter-collection.html" },
            { name: "MEN'S WINTER CAMO JACKET", price: "60.50", image: "https://res.cloudinary.com/dav8t2igs/image/upload/v1750180863/Screenshot_20250617_181137_Gallery_o1pbhj.jpg", url: "winter-collection.html" }
        ];

        // --- SEARCH FUNCTIONS ---
        function openSearchOverlay(){document.getElementById("searchOverlay").style.display="flex"}
        function closeSearchOverlay(){document.getElementById("searchOverlay").style.display="none"}
        function handleSearch(e){e.preventDefault();const t=e.target.querySelector(".search-input").value;window.location.href=`search.html?q=${encodeURIComponent(t)}`}
        
        function dynamicSearch(e) {
            const t = document.getElementById("searchResults");
            t.innerHTML = "";
            if ("" === e.trim()) {
                t.style.display = "none";
                return;
            }
            const o = e.toLowerCase();
            const uniqueProducts = Array.from(new Map(products.map(item => [item.name, item])).values());
            const n = uniqueProducts.filter(item => item.name.toLowerCase().includes(o));
            
            if (n.length > 0) {
                n.forEach(item => {
                    const resultLink = document.createElement("a");
                    resultLink.href = item.url;
                    resultLink.className = "search-result-item";
                    
                    resultLink.innerHTML = `
                        <img src="${item.image}" alt="${item.name}">
                        <div class="search-result-details">
                            <h4>${item.name}</h4>
                            <p>$${item.price}</p>
                        </div>
                        <button class="shop-now" data-name="${item.name}" data-price="${item.price}" data-image="${item.image}">Add to cart</button>
                    `;
                    t.appendChild(resultLink);
                });
                t.querySelectorAll('.shop-now').forEach(button => {
                    button.addEventListener('click', (ev) => {
                        ev.preventDefault();
                        const name = ev.target.dataset.name;
                        const price = parseFloat(ev.target.dataset.price);
                        const image = ev.target.dataset.image;
                        const product = { name, price, image, quantity: 1 };
                        let cart = JSON.parse(localStorage.getItem('cart')) || [];
                        const existingProductIndex = cart.findIndex(cartItem => cartItem.name === name);
                        if (existingProductIndex > -1) {
                            cart[existingProductIndex].quantity += 1;
                        } else {
                            cart.push(product);
                        }
                        localStorage.setItem('cart', JSON.stringify(cart));
                        updateCartCount();
                        alert(`'${name}' has been added to your cart.`);
                    });
                });

            } else {
                t.innerHTML = '<p style="padding: 10px; text-align: center;">No products found.</p>';
            }
            t.style.display = "block";
        }

        // --- FIREBASE AND USER AUTH FUNCTIONS ---
        const firebaseConfig = { apiKey: "AIzaSyDelMOFKyvYx4u9FCgpq1HTr9eAoyjBjS0", authDomain: "abuy-77b4e.firebaseapp.com", projectId: "abuy-77b4e", storageBucket: "abuy-77b4e.appspot.com", messagingSenderId: "1081289117876", appId: "1:1081289117876:web:b3479e942dea9dc14607e1", measurementId: "G-31SH8VCRYG" };
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const loginForm=document.getElementById("loginForm"),signupForm=document.getElementById("signupForm"),userAccountIcon=document.getElementById("userAccountIcon");
        loginForm&&loginForm.addEventListener("submit",async e=>{e.preventDefault();const t=document.getElementById("loginEmail").value,n=document.getElementById("loginPassword").value;try{await auth.signInWithEmailAndPassword(t,n),closeModal("loginModal")}catch(e){alert("Login failed: "+e.message)}}),signupForm&&signupForm.addEventListener("submit",async e=>{e.preventDefault();const t=document.getElementById("signupFirstName").value.trim(),n=document.getElementById("signupEmail").value,o=document.getElementById("signupPassword").value;try{const e=await auth.createUserWithEmailAndPassword(n,o);await e.user.updateProfile({displayName:t}),closeModal("signupModal")}catch(e){alert("Signup failed: "+e.message)}}),auth.onAuthStateChanged(e=>{const t=document.getElementById("userDropupMenu"),n=document.getElementById("welcomeUserName");e?(userAccountIcon&&(userAccountIcon.className="fas fa-user-check",userAccountIcon.onclick=()=>{t.style.display="block"===t.style.display?"none":"block"}),n&&(n.textContent=e.displayName||"user"),closeModal("loginModal"),closeModal("signupModal")):(userAccountIcon&&(userAccountIcon.className="fas fa-user",userAccountIcon.onclick=()=>openModal("loginModal")),t&&(t.style.display="none"),n&&(n.textContent="user"))});
        function openModal(e){document.getElementById(e).style.display="flex"}
        function closeModal(e){document.getElementById(e).style.display="none"}
        document.addEventListener("click",function(e){const t=document.getElementById("userDropupMenu"),n=document.getElementById("userAccountIcon");t&&n&&!t.contains(e.target)&&!n.contains(e.target)&&(t.style.display="none")}),document.getElementById("closeDropup").addEventListener("click",()=>{document.getElementById("userDropupMenu").style.display="none"}),document.getElementById("closeSettingsDropup").addEventListener("click",()=>{document.getElementById("userAccountSettingsMenu").style.display="none"}),document.getElementById("backToMainMenu").addEventListener("click",()=>{document.getElementById("userAccountSettingsMenu").style.display="none",document.getElementById("userDropupMenu").style.display="block"}),document.getElementById("accountSettingsMain").addEventListener("click",()=>{document.getElementById("userDropupMenu").style.display="none",document.getElementById("userAccountSettingsMenu").style.display="block",updateAccountSettingsMenu()}),document.getElementById("passwordPersonalInfoMain").addEventListener("click",()=>{const e=document.getElementById("userDropupMenu"),t=document.getElementById("userAccountSettingsMenu");e&&t&&(e.style.display="none",t.style.display="block",updateAccountSettingsMenu())}),document.getElementById("contactUs").addEventListener("click",()=>{window.open("https://www.instagram.com/ayman_achater?igsh=MTI3ZjJxbDMzdzd3cg==","_blank")}),document.getElementById("signOutMain").addEventListener("click",()=>{confirm("Are you sure you want to sign out?")&&auth.signOut().catch(e=>alert("Logout failed: "+e.message))}),document.getElementById("signOutSettings").addEventListener("click",()=>{confirm("Are you sure you want to sign out?")&&auth.signOut().catch(e=>alert("Logout failed: "+e.message))});
        function updateAccountSettingsMenu(){const e=auth.currentUser;e&&(document.getElementById("welcomeUserNameSettings").textContent=e.displayName||"user",document.getElementById("userNameDisplay").textContent=e.displayName||"user",document.getElementById("userEmailDisplay").textContent=e.email||"",document.getElementById("newPasswordInput").value="")}document.getElementById("changePasswordBtn").addEventListener("click",()=>{const e=document.getElementById("newPasswordInput").value.trim();if(e.length<6)return void alert("Password must be at least 6 characters long.");const t=auth.currentUser;t?t.updatePassword(e).then(()=>{alert("Password changed successfully."),document.getElementById("newPasswordInput").value=""}).catch(e=>alert("Failed to change password: "+e.message)):alert("No user is currently signed in.")});
    </script>
</body>
</html>
